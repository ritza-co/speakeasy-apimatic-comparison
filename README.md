# SDK Generation Tests

This repository compares an SDK generated by APIMatic to an SDK created by Speakeasy.

This is a companion repo to the [In Depth: Speakeasy vs APIMatic](https://speakeasyapi.dev/post/speakeasy-vs-apimatic) blog post by Speakeasy.

## Setup

1. Clone this repository and navigate to the root directory.

2. Install the [Speakeasy CLI](https://github.com/speakeasy-api/speakeasy?tab=readme-ov-file#installation) from GitHub, or using Homebrew (macOS):

```bash
brew install speakeasy
```

3. Authenticate with Speakeasy:

```bash
speakeasy auth login
```

4. Install [Bun](https://bun.sh/)

5. Generate the Speakeasy SDK:

```bash
speakeasy quickstart
```

Follow the prompts to select `openapi.yaml` as the API spec, `openapi` as the SDK name, and `bookstore-sdk-speakeasy` as the output directory.

6. Navigate to [APIMatic](https://www.apimatic.io/) and generate an SDK for the same schema.

7. Download the SDK generated by APIMatic and place it in the `bookstore-sdk-apimatic` directory.

8. Build the APIMatic SDK:

```bash
cd bookstore-sdk-apimatic
bun i
bun run build
```

9. Link the APIMatic SDK using Bun:

```bash
bun link
```

 1.  Build the SDK created by Speakeasy:

```bash
cd ../bookstore-sdk-speakeasy
bun i
bun run build
```

1.  Link the SDK using Bun:

```bash
bun link
```

11. Install [Prism](https://github.com/stoplightio/prism):

```bash
npm install -g @stoplight/prism-cli
```

12. Start the Prism mock server:

```bash
cd ..
prism mock openapi.yaml
```

13. In a new terminal, run the tests:

```bash
cd sdk-tests
bun run speakeasy.ts
bun run apimatic.ts
```

14. Compare the results of the tests.

## Bundling the Tests

We'll use `esbuild` to bundle the SDKs. First, install `esbuild`:

```bash
npm install esbuild
```

Build the SDKs:

```bash
node build.js
```

This generates two bundles, `dist/speakeasy.cjs` and `dist/apimatic.cjs`, along with their respective metafiles.

Speakeasy SDKs are designed to work in a range of environments, including the browser. To bundle an SDK for the browser, you can use a tool like `esbuild` or `webpack`.

Here's an example of how to bundle the Speakeasy SDK for the browser using `esbuild`:

```bash
npx esbuild speakeasy.ts --bundle --minify --target=es2020 --platform=browser --outfile=dist/speakeasy.js
```

This generates a bundle, `dist/speakeasy.js`, that can be used in the browser.
